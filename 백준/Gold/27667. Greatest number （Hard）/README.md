# [Gold V] Greatest number (Hard) - 27667 

[문제 링크](https://www.acmicpc.net/problem/27667) 

### 성능 요약

메모리: 32412 KB, 시간: 124 ms

### 분류

문자열, 애드 혹

### 제출 일자

2025년 12월 28일 23:22:06

### 문제 설명

<p>Little Peter loves playing at the junkyard. Today he found and brought home a broken scientific calculator. He did his best repairing it, but the calculator is still not in its best shape. Here is what still works:</p>

<ul>
	<li>There are some expressions stored in the memory of the calculator. Peter can load any of those onto the display.</li>
	<li>The arrow keys and the delete key still work. Using those, Peter can delete any subset of characters from the expression shown on the display.</li>
	<li>The equals sign works. Peter can press it to evaluate the expression shown on the display.</li>
</ul>

<p>Peter likes big numbers. For each of the expressions in his calculator find the largest number he can produce after pressing the equals sign.</p>

<p>You are given a string <em>S</em> that contains a valid arithmetic expression. Remove any (possibly none, but not all) characters from <em>S</em> so that the resulting string <em>T</em> is again a valid arithmetic expression and the value of <em>T</em> is as large as possible.</p>

<p>Valid expressions are defined as follows:</p>

<ul>
	<li>Any nonnegative integer is a valid expression, as long as it doesn’t have unnecessary leading zeros.</li>
	<li>If <code>a</code> is a valid expression then <code>(a)</code> is also a valid expression.</li>
	<li>If <code>a</code> is a valid expression then <code>-a</code> and <code>+a</code> are also valid expressions.</li>
	<li>If <code>a</code> and <code>b</code> are valid expressions then <code>a-b</code>, <code>a+b</code>, and <code>a*b</code> are also valid expressions.</li>
	<li>Nothing else is a valid expression.</li>
</ul>

<p>During the evaluation, the standard operator precedence applies:</p>

<ul>
	<li>Parentheses are evaluated first, overriding other precedence rules.</li>
	<li>Next, the (right associative) unary <code>+</code> and <code>-</code> are applied.</li>
	<li>Afterward, multiplication <code>*</code> is applied.</li>
	<li>And finally, addition <code>+</code> and subtraction <code>-</code> are applied from left to right.</li>
</ul>

<p>There are no other unary or binary operations except for the ones mentioned above. In particular, there is no division and no exponentiation.</p>

<p>Note that the definition allows multiple unary pluses and minuses to follow each other. For example, <code>1*(2+3*-+-4)</code> is a valid expression that is evaluated as follows: − + −4 is 4, 3 × 4 is 12, 2 + 12 is 14, and 1 × 14 is 14.</p>

<p>Also note that unnecessary leading zeros are <strong>not</strong> allowed. For example, <code>4-007</code> is not a valid expression.</p>

### 입력 

 <p>The first line of the input file contains an integer <em>t</em> specifying the number of test cases. Each test case is preceded by a blank line.</p>

<p>Every test case contains a single line containing a valid arithmetic expression <em>S</em>.</p>

### 출력 

 <p>For each test case, output one line with a valid arithmetic expression <em>T</em> such that <em>T</em> is a subsequence of <em>S</em> and such that <em>T</em> has the maximum possible value. If there are multiple solutions, print any of them.</p>

